<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Document Details</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
      .doc-detail{max-width:820px;margin:22px auto;padding:16px}
      .doc-row{display:flex;gap:12px;margin-bottom:10px}
      .doc-label{width:160px;color:var(--muted);font-weight:700}
      pre.notes{white-space:pre-wrap;background:#fbfdff;padding:8px;border-radius:6px}
      .back-link{display:inline-block;margin-bottom:12px}
    </style>
  </head>
  <body>
    <header>
      <h1>Document Details</h1>
    </header>

    <main class="doc-detail card">
      <a class="back-link" href="index.html">‚Üê Back to Dashboard</a>
      <div id="not-found" class="muted hidden">Document not found.</div>

      <div id="doc-content" class="hidden">
        <div class="doc-row"><div class="doc-label">Control #</div><div id="detail-control"></div></div>
        <div class="doc-row"><div class="doc-label">Title</div><div id="detail-title"></div></div>
        <div class="doc-row"><div class="doc-label">Owner</div><div id="detail-owner"></div></div>
        <div class="doc-row"><div class="doc-label">Status</div><div id="detail-status"></div></div>
        <div class="doc-row"><div class="doc-label">WINS Status</div><div id="detail-wins"></div></div>
        <div class="doc-row"><div class="doc-label">Created</div><div id="detail-created"></div></div>
        <div class="doc-row"><div class="doc-label">Updated</div><div id="detail-updated"></div></div>
        <div class="doc-row"><div class="doc-label">Notes</div><div><pre id="detail-notes" class="notes"></pre></div></div>
      </div>
    </main>

    <footer>
      <small><a href="index.html">Dashboard</a></small>
    </footer>

    <script>
      const STORAGE_KEY = 'dms_docs_v1';
      function queryParam(name){
        const u = new URL(location.href);
        return u.searchParams.get(name);
      }
      function formatDate(ms){
        if(!ms) return '';
        const d = new Date(Number(ms));
        return d.toLocaleString();
      }
      document.addEventListener('DOMContentLoaded', ()=>{
        const ctl = queryParam('control');
        if(!ctl){ document.getElementById('not-found').classList.remove('hidden'); return; }
        let docs = [];
        try{ docs = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); }catch(e){ docs = []; }
        const doc = docs.find(d => d.controlNumber === ctl);
        if(!doc){ document.getElementById('not-found').classList.remove('hidden'); return; }
        document.getElementById('doc-content').classList.remove('hidden');
        document.getElementById('detail-control').textContent = doc.controlNumber || '';
        document.getElementById('detail-title').textContent = doc.title || '';
        document.getElementById('detail-owner').textContent = doc.owner || '';
        document.getElementById('detail-status').textContent = doc.status || '';
        document.getElementById('detail-wins').textContent = doc.winsStatus || '';
        document.getElementById('detail-created').textContent = formatDate(doc.createdAt);
        document.getElementById('detail-updated').textContent = formatDate(doc.updatedAt);
        document.getElementById('detail-notes').textContent = doc.notes || '';
      });
    </script>
  </body>
</html>
